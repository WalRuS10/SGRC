SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

DROP SCHEMA IF EXISTS `PROYECTO`;

CREATE SCHEMA IF NOT EXISTS `PROYECTO`;


USE `PROYECTO` ;

-- -----------------------------------------------------
-- Table `PROYECTO`.`EMPLEADOS`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `PROYECTO`.`EMPLEADOS` ;

CREATE  TABLE IF NOT EXISTS `PROYECTO`.`EMPLEADOS` (
  `LEGAJO` INT NOT NULL ,
  `NOMBRE` VARCHAR(50) NOT NULL ,
  `APELLIDO` VARCHAR(50) NOT NULL ,
  `DOMICILIO` VARCHAR(50) NULL ,
  `TELEFONO` INT NULL ,
  `PASSWORD` VARCHAR(100) NULL ,
  PRIMARY KEY (`LEGAJO`) )
ENGINE = InnoDB;


INSERT INTO `empleados` (`LEGAJO`, `NOMBRE`, `APELLIDO`, `DOMICILIO`, `TELEFONO`, `PASSWORD`) VALUES
(1, 'admin', '', '', 0, 'admin');

-- -----------------------------------------------------
-- Table `PROYECTO`.`TECNICOS`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `PROYECTO`.`TECNICOS` ;

CREATE  TABLE IF NOT EXISTS `PROYECTO`.`TECNICOS` (
  `LEGAJO` INT NOT NULL ,
  PRIMARY KEY (`LEGAJO`) ,
  INDEX `LEGAJO_idx` (`LEGAJO` ASC) ,
  CONSTRAINT `FK_LEGAJO_TEC`
    FOREIGN KEY (`LEGAJO` )
    REFERENCES `PROYECTO`.`EMPLEADOS` (`LEGAJO` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `PROYECTO`.`ENCARGADOS`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `PROYECTO`.`ENCARGADOS` ;

CREATE  TABLE IF NOT EXISTS `PROYECTO`.`ENCARGADOS` (
  `LEGAJO` INT NOT NULL ,
  PRIMARY KEY (`LEGAJO`) ,
  INDEX `LEGAJO_idx` (`LEGAJO` ASC) ,
  CONSTRAINT `FK_LEGAJO_ENC`
    FOREIGN KEY (`LEGAJO` )
    REFERENCES `PROYECTO`.`EMPLEADOS` (`LEGAJO` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `PROYECTO`.`ADMINISTRADORES`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `PROYECTO`.`ADMINISTRADORES` ;

CREATE  TABLE IF NOT EXISTS `PROYECTO`.`ADMINISTRADORES` (
  `LEGAJO` INT NOT NULL ,
  PRIMARY KEY (`LEGAJO`) ,
  INDEX `LEGAJO_idx` (`LEGAJO` ASC) ,
  CONSTRAINT `FK_LEGAJO_ADM`
    FOREIGN KEY (`LEGAJO` )
    REFERENCES `PROYECTO`.`EMPLEADOS` (`LEGAJO` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `PROYECTO`.`CLIENTES`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `PROYECTO`.`CLIENTES` ;

CREATE  TABLE IF NOT EXISTS `PROYECTO`.`CLIENTES` (
  `CUIT` VARCHAR(13) NOT NULL ,
  `RAZON_SOCIAL` VARCHAR(50) NOT NULL ,
  `DOMICILIO` VARCHAR(50) NULL ,
  `TELEFONO` INT NULL ,
  `LEGAJO_ENCARGADO` INT NOT NULL ,
  `ESTADO` VARCHAR(10) NOT NULL ,
  PRIMARY KEY (`CUIT`) ,
  INDEX `LEGAJO_ENCARGADO_idx` (`LEGAJO_ENCARGADO` ASC) ,
  CONSTRAINT `FK_LEGAJO_ENC1`
    FOREIGN KEY (`LEGAJO_ENCARGADO` )
    REFERENCES `PROYECTO`.`ENCARGADOS` (`LEGAJO` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)  
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `PROYECTO`.`COMPUTADORAS`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `PROYECTO`.`COMPUTADORAS` ;

CREATE  TABLE IF NOT EXISTS `PROYECTO`.`COMPUTADORAS` (
  `ID_COMPUTADORA` INT NOT NULL AUTO_INCREMENT,
  `CUIT_CLIENTE` VARCHAR(13) NOT NULL ,
  `FECHA_INGRESO` DATE NOT NULL ,
  PRIMARY KEY (`ID_COMPUTADORA`) ,
  INDEX `CUIT_CLIENTE_idx` (`CUIT_CLIENTE` ASC) ,
  CONSTRAINT `FK_CUIT_CLIENTE`
    FOREIGN KEY (`CUIT_CLIENTE` )
    REFERENCES `PROYECTO`.`CLIENTES` (`CUIT` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `PROYECTO`.`ESTADOS_REPARACIONES`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `PROYECTO`.`ESTADOS_REPARACIONES` ;

CREATE  TABLE IF NOT EXISTS `PROYECTO`.`ESTADOS_REPARACIONES` (
  `ID_ESTADO` INT NOT NULL AUTO_INCREMENT,
  `DESCRIPCION` VARCHAR(50) NOT NULL ,
  PRIMARY KEY (`ID_ESTADO`) )
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `PROYECTO`.`REPARACIONES`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `PROYECTO`.`REPARACIONES` ;

CREATE  TABLE IF NOT EXISTS `PROYECTO`.`REPARACIONES` (
  `NRO_ORDEN` INT NOT NULL AUTO_INCREMENT,
  `ID_COMPUTADORA` INT NOT NULL ,
  `ESTADO_REPARACION` INT NULL ,
  `FALLA` VARCHAR(100) NULL ,
  `OBSERVACIONES` VARCHAR(100) NULL ,
  `FECHA_ENTREGA` DATE NULL ,
  PRIMARY KEY (`NRO_ORDEN`) ,
  INDEX `ID_COMPUTADORA_idx` (`ID_COMPUTADORA` ASC) ,
  INDEX `FK_ESTADO_REPARACION_idx` (`ESTADO_REPARACION` ASC) ,
  CONSTRAINT `FK_ID_COMPUTADORA`
    FOREIGN KEY (`ID_COMPUTADORA` )
    REFERENCES `PROYECTO`.`COMPUTADORAS` (`ID_COMPUTADORA` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_ESTADO_REPARACION`
    FOREIGN KEY (`ESTADO_REPARACION` )
    REFERENCES `PROYECTO`.`ESTADOS_REPARACIONES` (`ID_ESTADO` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `PROYECTO`.`COMPONENTES`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `PROYECTO`.`COMPONENTES` ;

CREATE  TABLE IF NOT EXISTS `PROYECTO`.`COMPONENTES` (
  `ID_COMPONENTE` INT NOT NULL AUTO_INCREMENT,
  `DESCRIPCION` VARCHAR(50) NOT NULL ,
  `STOCK` INT UNSIGNED NOT NULL DEFAULT 0 ,
  `PRECIO_COMPRA` DOUBLE NULL ,
  PRIMARY KEY (`ID_COMPONENTE`) )
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `PROYECTO`.`REPARACIONES_COMPONENTES`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `PROYECTO`.`REPARACIONES_COMPONENTES` ;

CREATE  TABLE IF NOT EXISTS `PROYECTO`.`REPARACIONES_COMPONENTES` (
  `NRO_ORDEN` INT NOT NULL ,
  `ID_COMPONENTE` INT NOT NULL ,
  `CANTIDAD` INT UNSIGNED NOT NULL DEFAULT 1 ,
  PRIMARY KEY (`NRO_ORDEN`, `ID_COMPONENTE`) ,
  INDEX `FK_NRO_ORDEN_idx` (`NRO_ORDEN` ASC) ,
  INDEX `FK_ID_COMPONENTE_idx` (`ID_COMPONENTE` ASC) ,
  CONSTRAINT `FK_NRO_ORDEN2`
    FOREIGN KEY (`NRO_ORDEN` )
    REFERENCES `PROYECTO`.`REPARACIONES` (`NRO_ORDEN` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_ID_COMPONENTE1`
    FOREIGN KEY (`ID_COMPONENTE` )
    REFERENCES `PROYECTO`.`COMPONENTES` (`ID_COMPONENTE` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `PROYECTO`.`PROVEEDORES`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `PROYECTO`.`PROVEEDORES` ;

CREATE  TABLE IF NOT EXISTS `PROYECTO`.`PROVEEDORES` (
  `CUIT` VARCHAR(13) NOT NULL ,
  `RAZON_SOCIAL` VARCHAR(50) NOT NULL ,
  `DOMICILIO` VARCHAR(50) NULL ,
  `TELEFONO` INT NULL ,
  PRIMARY KEY (`CUIT`) )
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `PROYECTO`.`PROVEEDORES_COMPONENTES`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `PROYECTO`.`PROVEEDORES_COMPONENTES` ;

CREATE  TABLE IF NOT EXISTS `PROYECTO`.`PROVEEDORES_COMPONENTES` (
  `ID_COMPONENTE` INT NOT NULL ,
  `CUIT_PROVEEDOR` VARCHAR(13) NOT NULL ,
  `PRECIO` DOUBLE NULL ,
  PRIMARY KEY (`ID_COMPONENTE`, `CUIT_PROVEEDOR`) ,
  INDEX `FK_ID_COMPONENTE_idx` (`ID_COMPONENTE` ASC) ,
  INDEX `FK_CUIT_PROVEEDOR_idx` (`CUIT_PROVEEDOR` ASC) ,
  CONSTRAINT `FK_ID_COMPONENTE2`
    FOREIGN KEY (`ID_COMPONENTE` )
    REFERENCES `PROYECTO`.`COMPONENTES` (`ID_COMPONENTE` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_CUIT_PROVEEDOR`
    FOREIGN KEY (`CUIT_PROVEEDOR` )
    REFERENCES `PROYECTO`.`PROVEEDORES` (`CUIT` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `PROYECTO`.`TECNICOS_REPARACIONES`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `PROYECTO`.`TECNICOS_REPARACIONES` ;

CREATE  TABLE IF NOT EXISTS `PROYECTO`.`TECNICOS_REPARACIONES` (
  `NRO_ORDEN_REPARACION` INT NOT NULL ,
  `LEGAJO_TECNICO` INT NOT NULL ,
  PRIMARY KEY (`NRO_ORDEN_REPARACION`, `LEGAJO_TECNICO`) ,
  INDEX `NRO_ORDEN_REPARACION_idx` (`NRO_ORDEN_REPARACION` ASC) ,
  INDEX `LEGAJO_TECNICO_idx` (`LEGAJO_TECNICO` ASC) ,
  CONSTRAINT `FK_NRO_ORDEN1`
    FOREIGN KEY (`NRO_ORDEN_REPARACION` )
    REFERENCES `PROYECTO`.`REPARACIONES` (`NRO_ORDEN` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_LEGAJO_TEC1`
    FOREIGN KEY (`LEGAJO_TECNICO` )
    REFERENCES `PROYECTO`.`TECNICOS` (`LEGAJO` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;



SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
